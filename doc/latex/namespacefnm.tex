\hypertarget{namespacefnm}{\section{fnm Namespace Reference}
\label{namespacefnm}\index{fnm@{fnm}}
}


Fast Nearfield Method interfaces and implementations.  


\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classfnm_1_1Aperture}{Aperture}
\begin{DoxyCompactList}\small\item\em \hyperlink{classfnm_1_1Aperture}{Aperture} class. \end{DoxyCompactList}\item 
struct \hyperlink{singletonfnm_1_1ApertureData}{Aperture\+Data}
\begin{DoxyCompactList}\small\item\em Forward-\/declare \hyperlink{singletonfnm_1_1ApertureData}{Aperture\+Data}. \end{DoxyCompactList}\item 
struct \hyperlink{structfnm_1_1element__t}{element\+\_\+t}
\begin{DoxyCompactList}\small\item\em Element representation. \end{DoxyCompactList}\item 
struct \hyperlink{structfnm_1_1FocusingTypeNS}{Focusing\+Type\+N\+S}
\item 
struct \hyperlink{structfnm_1_1sysparm__t}{sysparm\+\_\+t}
\begin{DoxyCompactList}\small\item\em Sysparm structure. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef \hyperlink{structfnm_1_1FocusingTypeNS_a896c037a32087c5c20d97e64a1786880}{Focusing\+Type\+N\+S\+::\+Value} \hyperlink{namespacefnm_ac5c8ed1b3501db991ccb6065c89c3b54}{Focusing\+Type}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
{\footnotesize template$<$class T $>$ }\\std\+::complex$<$ T $>$ \hyperlink{namespacefnm_a1486ec1da93598ab2d37b17cf9f62252}{Calc\+Hz} (const T \&s, const T \&l, const T \&z, const T \&k, const T $\ast$uxs, const T $\ast$uweights, const size\+\_\+t n\+Us, const T $\ast$vxs, const T $\ast$vweights, const size\+\_\+t n\+Vs)
\item 
{\footnotesize template$<$class T $>$ }\\int \hyperlink{namespacefnm_a563d8aee788257300131ed9a7af75f64}{Calc\+Cw\+Field\+Ref} (const \hyperlink{singletonfnm_1_1ApertureData}{Aperture\+Data}$<$ T $>$ \&data, const T $\ast$pos, const size\+\_\+t n\+Positions, std\+::complex$<$ T $>$ $\ast$$\ast$odata)
\item 
{\footnotesize template$<$class T $>$ }\\void \hyperlink{namespacefnm_a262768119606bb7e361e68564ba88829}{Calc\+Cw\+Field} (const \hyperlink{singletonfnm_1_1ApertureData}{Aperture\+Data}$<$ T $>$ \&data, const T $\ast$pos, const size\+\_\+t n\+Positions, std\+::complex$<$ T $>$ $\ast$$\ast$odata)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Fast Nearfield Method interfaces and implementations. 

\subsection{Typedef Documentation}
\hypertarget{namespacefnm_ac5c8ed1b3501db991ccb6065c89c3b54}{\index{fnm@{fnm}!Focusing\+Type@{Focusing\+Type}}
\index{Focusing\+Type@{Focusing\+Type}!fnm@{fnm}}
\subsubsection[{Focusing\+Type}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf Focusing\+Type\+N\+S\+::\+Value} {\bf Focusing\+Type}}}\label{namespacefnm_ac5c8ed1b3501db991ccb6065c89c3b54}


\subsection{Function Documentation}
\hypertarget{namespacefnm_a262768119606bb7e361e68564ba88829}{\index{fnm@{fnm}!Calc\+Cw\+Field@{Calc\+Cw\+Field}}
\index{Calc\+Cw\+Field@{Calc\+Cw\+Field}!fnm@{fnm}}
\subsubsection[{Calc\+Cw\+Field}]{\setlength{\rightskip}{0pt plus 5cm}void fnm\+::\+Calc\+Cw\+Field (
\begin{DoxyParamCaption}
\item[{const Aperture\+Data$<$ T $>$ \&}]{data, }
\item[{const T $\ast$}]{pos, }
\item[{const size\+\_\+t}]{n\+Positions, }
\item[{std\+::complex$<$ T $>$ $\ast$$\ast$}]{odata}
\end{DoxyParamCaption}
)}}\label{namespacefnm_a262768119606bb7e361e68564ba88829}
Naive integral, no re-\/use of parts and many abcissa are needed when projection is far away from rectangle


\begin{DoxyParams}{Parameters}
{\em data} & \\
\hline
{\em pos} & \\
\hline
{\em n\+Positions} & \\
\hline
{\em odata} & \\
\hline
\end{DoxyParams}
\hypertarget{namespacefnm_a563d8aee788257300131ed9a7af75f64}{\index{fnm@{fnm}!Calc\+Cw\+Field\+Ref@{Calc\+Cw\+Field\+Ref}}
\index{Calc\+Cw\+Field\+Ref@{Calc\+Cw\+Field\+Ref}!fnm@{fnm}}
\subsubsection[{Calc\+Cw\+Field\+Ref}]{\setlength{\rightskip}{0pt plus 5cm}int fnm\+::\+Calc\+Cw\+Field\+Ref (
\begin{DoxyParamCaption}
\item[{const Aperture\+Data$<$ T $>$ \&}]{data, }
\item[{const T $\ast$}]{pos, }
\item[{const size\+\_\+t}]{n\+Positions, }
\item[{std\+::complex$<$ T $>$ $\ast$$\ast$}]{odata}
\end{DoxyParamCaption}
)}}\label{namespacefnm_a563d8aee788257300131ed9a7af75f64}
Spatial impulse response computed at the positions pos for a frequency f0. The frequency f0 as well as the positional information for the aperture is contained in the data structure. \begin{DoxyVerb}            ^
            |
      +-----+-----+-----------+ (x,y)
      |     |     |           |
      +-----+-----+-----------+
      |     |     |           |
      |     |     |           |
      |     |     |           |
      +     o-----+-----------+---->
      |           |           |
  hh  |           |           |
      |           |           |
      +-----+-----+-----------+
              hw\end{DoxyVerb}


(Scalar reference implementation)


\begin{DoxyParams}{Parameters}
{\em data} & Structure holding element positions and f0 \\
\hline
{\em pos} & Positions \\
\hline
{\em n\+Positions} & \# of positions \\
\hline
{\em odata} & complex output \\
\hline
\end{DoxyParams}
\hypertarget{namespacefnm_a1486ec1da93598ab2d37b17cf9f62252}{\index{fnm@{fnm}!Calc\+Hz@{Calc\+Hz}}
\index{Calc\+Hz@{Calc\+Hz}!fnm@{fnm}}
\subsubsection[{Calc\+Hz}]{\setlength{\rightskip}{0pt plus 5cm}std\+::complex$<$T$>$ fnm\+::\+Calc\+Hz (
\begin{DoxyParamCaption}
\item[{const T \&}]{s, }
\item[{const T \&}]{l, }
\item[{const T \&}]{z, }
\item[{const T \&}]{k, }
\item[{const T $\ast$}]{uxs, }
\item[{const T $\ast$}]{uweights, }
\item[{const size\+\_\+t}]{n\+Us, }
\item[{const T $\ast$}]{vxs, }
\item[{const T $\ast$}]{vweights, }
\item[{const size\+\_\+t}]{n\+Vs}
\end{DoxyParamCaption}
)}}\label{namespacefnm_a1486ec1da93598ab2d37b17cf9f62252}
Field above a corner of an element with dimensions $s$ and $l$ computed using Gauss-\/\+Legendre integration

\begin{eqnarray*}H_{s,l}(z;k) = - i/(2\pi k) ( &s \int_0^l (exp(-ik\sqrt{\sigma^2+z^2+s^2}) - exp(-ikz)) / (\sigma^2+s^2) d\sigma + \\ &l \int_0^s (exp(-ik\sqrt{\sigma^2+z^2+l^2}) - exp(-ikz)) / (\sigma^2+l^2) d\sigma) \end{eqnarray*}

Reference implementation, see \href{http://www.ncbi.nlm.nih.gov/pmc/articles/pmid/15139602/}{\tt Rapid calculations of time-\/harmonic nearfield pressures produced by rectangular pistons, J. Mc\+Gough, 2004}


\begin{DoxyParams}{Parameters}
{\em s} & width (x-\/dimension) \\
\hline
{\em l} & height (y-\/dimension) \\
\hline
{\em z} & distance to element \\
\hline
{\em k} & wave-\/number \\
\hline
{\em uxs} & abcissa coordinates for x-\/coordinate \\
\hline
{\em uweights} & weights for x-\/coordinate \\
\hline
{\em n\+Us} & number of x-\/coordinates \\
\hline
{\em vxs} & abcissa coordinates for y-\/coordinate \\
\hline
{\em vweights} & weights for y-\/coordinate \\
\hline
{\em n\+Vs} & number of y-\/coordinates\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
Complex field value 
\end{DoxyReturn}
