(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14487,        356]
NotebookOptionsPosition[     13984,        336]
NotebookOutlinePosition[     14319,        351]
CellTagsIndexPosition[     14276,        348]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"symboliclegendre", "[", 
    RowBox[{"n_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"LegendreP", "[", 
      RowBox[{"n", ",", "x"}], "]"}], "\[Equal]", "0"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.666861324220025*^9, 3.66686135061723*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"legendreprime", "[", 
    RowBox[{"n_", ",", "a_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"LegendreP", "[", 
       RowBox[{"n", ",", "x"}], "]"}], ",", "x"}], "]"}], "/.", 
    RowBox[{"x", "\[Rule]", "a"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.666861362447176*^9, 3.6668613778456297`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"weights", "[", 
    RowBox[{"n_", ",", "x_"}], "]"}], ":=", 
   RowBox[{"2", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"x", "^", "2"}]}], ")"}], " ", 
      RowBox[{
       RowBox[{"legendreprime", "[", 
        RowBox[{"n", ",", "x"}], "]"}], "^", "2"}]}], ")"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{3.666861400961377*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "how", " ", "many", " ", "terms", " ", "should", " ", "be", " ", 
    "generated"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"h", " ", "=", " ", "101"}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"what", " ", "numerical", " ", "precision", " ", "is", " ", 
     RowBox[{"desired", "?"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"precision", " ", "=", " ", 
     RowBox[{"Ceiling", "[", 
      RowBox[{"N", "[", 
       RowBox[{"Log", "[", 
        RowBox[{"10", ",", 
         RowBox[{"2", "^", "52"}]}], "]"}], "]"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6668741215143337`*^9, 3.666874131928874*^9}, {
  3.666877658407189*^9, 3.666877667522203*^9}}],

Cell["\<\
str = OpenWrite[\"lgvalues.txt\"];
WriteString[str, \"/* abcissae */\"];
Do[Write[str]; WriteString[str,\"abcissa\",n,\"[\",n,\"]=\"]; \
Write[str];WriteString[str,\"{\"];
  nlist = symboliclegendre[n, x];
  xnlist = x /. nlist;
  order = Join[Reverse[Range[Mod[n-1,2],n-1,2]], Range[Mod[n,2],n-2,2]] + 1;
  Do[WriteString[str, N[Re[Part[xnlist, i]], precision],\",\"], {i, \
order[[1;;-2]]}];
  WriteString[str, N[Re[Part[xnlist, order[[-1]]]], precision],\"};\"];
  Write[str];, {n, 2, h}];
Write[str];
WriteString[str, \"/* weights */\"];
Do[Write[str]; WriteString[str,\"weight\",n,\"[\",n,\"]=\"]; \
Write[str];WriteString[str,\"{\"];
  slist := symboliclegendre[n, x];
  xslist = x /. slist;
  order = Join[Reverse[Range[Mod[n-1,2],n-1,2]], Range[Mod[n,2],n-2,2]] + 1;
  Do[WriteString[str, N[Re[weights[n, Part[xslist, i]]], precision],\",\"], \
{i, order[[1;;-2]]}];
  WriteString[str, N[Re[weights[n,Part[xslist, order[[-1]]]]], \
precision],\"};\"];
  Write[str];, {n, 2, h}];\
\>", "Input",
 CellChangeTimes->{{3.6668589690923243`*^9, 3.666858969851665*^9}, {
   3.666861279032599*^9, 3.6668613047473907`*^9}, {3.666861347335157*^9, 
   3.66686140820969*^9}, 3.666862636343356*^9, {3.6668640678338737`*^9, 
   3.666864068779387*^9}, {3.66686418781363*^9, 3.666864188374034*^9}, {
   3.666864356763022*^9, 3.666864357360217*^9}, {3.6668644781970797`*^9, 
   3.666864501208414*^9}, {3.666864761788142*^9, 3.666864783670185*^9}, {
   3.666864878304447*^9, 3.666864917998412*^9}, {3.66686517096332*^9, 
   3.6668651722009983`*^9}, {3.666865476700992*^9, 3.666865524550785*^9}, {
   3.6668656288394117`*^9, 3.666865657721025*^9}, {3.6668659391670313`*^9, 
   3.66686599246706*^9}, {3.666866052254035*^9, 3.666866078758497*^9}, {
   3.666866203763051*^9, 3.666866225547944*^9}, {3.66686627828946*^9, 
   3.6668662899976797`*^9}, {3.666866379867394*^9, 3.6668663940253277`*^9}, {
   3.6668665455338583`*^9, 3.6668665765788403`*^9}, {3.666866635259486*^9, 
   3.66686669887251*^9}, {3.666866747602242*^9, 3.66686678462717*^9}, {
   3.6668668584004793`*^9, 3.6668668701138077`*^9}, {3.6668669077512503`*^9, 
   3.6668669159995832`*^9}, {3.666866956224206*^9, 3.666867039078006*^9}, {
   3.666867124891612*^9, 3.666867180419486*^9}, {3.66686725413665*^9, 
   3.666867286171403*^9}, {3.666867374918693*^9, 3.6668673821200037`*^9}, {
   3.666867458582068*^9, 3.666867501398756*^9}, {3.6668676558607683`*^9, 
   3.6668676559912777`*^9}, {3.666867736212886*^9, 3.666867737689721*^9}, {
   3.666868523250434*^9, 3.666868529990004*^9}, {3.666868757194744*^9, 
   3.66686878819125*^9}, {3.666868870493029*^9, 3.6668688735430098`*^9}, {
   3.666868914171125*^9, 3.6668689408553143`*^9}, {3.6668690347299747`*^9, 
   3.666869090402914*^9}, {3.666869124411261*^9, 3.666869154988817*^9}, 
   3.666869188325163*^9, {3.666869228582438*^9, 3.6668692364592667`*^9}, {
   3.6668693236461487`*^9, 3.666869335269698*^9}, 3.666869380174921*^9, {
   3.6668694875557127`*^9, 3.66686951205415*^9}, {3.6668695577450743`*^9, 
   3.6668697093346243`*^9}, {3.666869912216919*^9, 3.666869923197659*^9}, {
   3.666869994988531*^9, 3.6668700085117283`*^9}, {3.6668704482698517`*^9, 
   3.6668704671439037`*^9}, {3.666870662872242*^9, 3.6668706767827806`*^9}, {
   3.666870955402223*^9, 3.6668709666990767`*^9}, {3.666873289945738*^9, 
   3.6668733118001537`*^9}, {3.666873371528163*^9, 3.666873381013728*^9}, {
   3.666873764136939*^9, 3.666873777030884*^9}, {3.666874116961362*^9, 
   3.6668741395923843`*^9}, {3.6668760859699087`*^9, 3.6668760918906517`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Close", "[", "str", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.666866031082109*^9, 3.666866031083475*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"str", " ", "=", " ", 
   RowBox[{"OpenWrite", "[", "\"\<lgvalues_compact.txt\>\"", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"str", ",", " ", "\"\</* abcissae */\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Write", "[", "str", "]"}], ";", " ", 
     RowBox[{"WriteString", "[", 
      RowBox[{
      "str", ",", "\"\<abcissa\>\"", ",", "n", ",", "\"\<[\>\"", ",", 
       RowBox[{"Floor", "[", 
        RowBox[{"n", "/", "2"}], "]"}], ",", "\"\<]=\>\""}], "]"}], ";", " ", 
     
     RowBox[{"Write", "[", "str", "]"}], ";", 
     RowBox[{"WriteString", "[", 
      RowBox[{"str", ",", "\"\<{\>\""}], "]"}], ";", "\n", "    ", 
     RowBox[{"nlist", " ", "=", " ", 
      RowBox[{"symboliclegendre", "[", 
       RowBox[{"n", ",", " ", "x"}], "]"}]}], ";", "\n", "    ", 
     RowBox[{"xnlist", " ", "=", " ", 
      RowBox[{"x", " ", "/.", " ", "nlist"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"xnlist", " ", "=", " ", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"ArcCos", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"Re", "[", "xnlist", "]"}], "]"}], "]"}], "]"}], ",", 
        "precision"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"order", " ", "=", " ", 
      RowBox[{"Ordering", "[", "xnlist", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"order", " ", "=", " ", 
      RowBox[{"Reverse", "[", 
       RowBox[{"order", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", "+", 
           RowBox[{"Mod", "[", 
            RowBox[{"n", ",", "2"}], "]"}]}], ";;", "n", ";;", "2"}], "]"}], 
        "]"}], "]"}]}], ";", "\n", "    ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"WriteString", "[", 
        RowBox[{"str", ",", " ", 
         RowBox[{"Part", "[", 
          RowBox[{"xnlist", ",", " ", "i"}], "]"}], ",", "\"\<,\>\""}], "]"}],
        ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"order", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}]}], "}"}]}], "]"}], ";", "\n", 
     "    ", 
     RowBox[{"WriteString", "[", 
      RowBox[{"str", ",", " ", 
       RowBox[{"Part", "[", 
        RowBox[{"xnlist", ",", " ", 
         RowBox[{"order", "[", 
          RowBox[{"[", 
           RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}], ",", "\"\<};\>\""}], 
      "]"}], ";", "\n", "    ", 
     RowBox[{"Write", "[", "str", "]"}], ";"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", " ", "2", ",", " ", "h"}], "}"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Write", "[", "str", "]"}], ";"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Odd", " ", "weight", " ", "include", " ", "the", " ", "weight", " ", "at",
     " ", "0"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"str", ",", " ", "\"\</* weights */\>\""}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Write", "[", "str", "]"}], ";", " ", 
     RowBox[{"WriteString", "[", 
      RowBox[{"str", ",", "\"\<weight\>\"", ",", "n", ",", "\"\<[\>\"", ",", 
       RowBox[{"Ceiling", "[", 
        RowBox[{"n", "/", "2"}], "]"}], ",", "\"\<]=\>\""}], "]"}], ";", " ", 
     
     RowBox[{"Write", "[", "str", "]"}], ";", 
     RowBox[{"WriteString", "[", 
      RowBox[{"str", ",", "\"\<{\>\""}], "]"}], ";", "\n", "  ", 
     RowBox[{"slist", " ", ":=", " ", 
      RowBox[{"symboliclegendre", "[", 
       RowBox[{"n", ",", " ", "x"}], "]"}]}], ";", "\n", "  ", 
     RowBox[{"xslist", " ", "=", " ", 
      RowBox[{"x", " ", "/.", " ", "slist"}]}], ";", "\n", "  ", 
     RowBox[{"xnlist", " ", "=", " ", 
      RowBox[{"N", "[", 
       RowBox[{
        RowBox[{"Abs", "[", 
         RowBox[{"ArcCos", "[", 
          RowBox[{"Abs", "[", 
           RowBox[{"Re", "[", "xslist", "]"}], "]"}], "]"}], "]"}], ",", 
        "precision"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"order", " ", "=", " ", 
      RowBox[{"Ordering", "[", "xnlist", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"order", " ", "=", " ", 
      RowBox[{"Reverse", "[", 
       RowBox[{"order", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "n", ";;", "2"}], "]"}], "]"}], "]"}]}], ";", 
     "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{"WriteString", "[", 
        RowBox[{"str", ",", " ", 
         RowBox[{"N", "[", 
          RowBox[{
           RowBox[{"Re", "[", 
            RowBox[{"weights", "[", 
             RowBox[{"n", ",", " ", 
              RowBox[{"Part", "[", 
               RowBox[{"xslist", ",", " ", "i"}], "]"}]}], "]"}], "]"}], ",", 
           " ", "precision"}], "]"}], ",", "\"\<,\>\""}], "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"order", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", 
            RowBox[{"-", "2"}]}], "]"}], "]"}]}], "}"}]}], "]"}], ";", "\n", 
     "  ", 
     RowBox[{"WriteString", "[", 
      RowBox[{"str", ",", " ", 
       RowBox[{"N", "[", 
        RowBox[{
         RowBox[{"Re", "[", 
          RowBox[{"weights", "[", 
           RowBox[{"n", ",", 
            RowBox[{"Part", "[", 
             RowBox[{"xslist", ",", " ", 
              RowBox[{"order", "[", 
               RowBox[{"[", 
                RowBox[{"-", "1"}], "]"}], "]"}]}], "]"}]}], "]"}], "]"}], 
         ",", " ", "precision"}], "]"}], ",", "\"\<};\>\""}], "]"}], ";", 
     "\n", "  ", 
     RowBox[{"Write", "[", "str", "]"}], ";"}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", " ", "2", ",", " ", "h"}], "}"}]}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.66687097602767*^9, 3.666870982181753*^9}, {
   3.666871047104885*^9, 3.666871132861168*^9}, {3.6668715357654448`*^9, 
   3.666871549633814*^9}, {3.666871675728704*^9, 3.666871788450811*^9}, {
   3.666871846334387*^9, 3.6668718564895697`*^9}, {3.666871894057972*^9, 
   3.666871907705456*^9}, {3.666871956280904*^9, 3.666871966631074*^9}, {
   3.666872084995085*^9, 3.666872088867608*^9}, {3.66687213528168*^9, 
   3.666872135931839*^9}, {3.666872295001893*^9, 3.6668722953394938`*^9}, {
   3.6668727396168537`*^9, 3.666872753258667*^9}, {3.666872797536812*^9, 
   3.666872808236113*^9}, {3.6668728997735777`*^9, 3.666872905375496*^9}, {
   3.666872961506877*^9, 3.6668730067219133`*^9}, {3.666873047116591*^9, 
   3.6668730755525637`*^9}, {3.666873214147777*^9, 3.666873225699402*^9}, {
   3.6668732586228848`*^9, 3.66687327194597*^9}, {3.666874282061591*^9, 
   3.6668742873870277`*^9}, {3.666874406492565*^9, 3.6668744088279753`*^9}, {
   3.666874861328806*^9, 3.6668749284765453`*^9}, {3.66687585645192*^9, 
   3.666875877100771*^9}, {3.6668759162142563`*^9, 3.666875922651322*^9}, {
   3.666875984908554*^9, 3.666875989333281*^9}, {3.6668760979291573`*^9, 
   3.6668761557121897`*^9}, {3.666876198627013*^9, 3.666876211390139*^9}, 
   3.666876246807556*^9, {3.66687630041118*^9, 3.666876325353582*^9}, {
   3.666876413111021*^9, 3.6668764568239183`*^9}, {3.666876501837655*^9, 
   3.666876507552907*^9}, {3.66687667633508*^9, 3.66687668009233*^9}, {
   3.666876738462748*^9, 3.6668767567521257`*^9}, {3.6668768511384373`*^9, 
   3.66687685191779*^9}, {3.666876882904724*^9, 3.666876884178035*^9}, {
   3.666876926426846*^9, 3.666876982124277*^9}, {3.66687702827569*^9, 
   3.6668770309737883`*^9}, {3.666877305693719*^9, 3.6668773365793552`*^9}, {
   3.666877600036333*^9, 3.666877619223344*^9}, {3.666878101645204*^9, 
   3.66687813983291*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Close", "[", "str", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.6668709923018723`*^9, 3.6668709976834*^9}}]
},
WindowSize->{1054, 693},
WindowMargins->{{Automatic, 61}, {Automatic, 39}},
FrontEndVersion->"10.0 for Linux x86 (64-bit) (June 27, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 338, 10, 32, "Input"],
Cell[899, 32, 384, 11, 32, "Input"],
Cell[1286, 45, 435, 15, 32, "Input"],
Cell[1724, 62, 749, 21, 99, "Input"],
Cell[2476, 85, 3543, 58, 338, "Input"],
Cell[6022, 145, 144, 3, 32, "Input"],
Cell[6169, 150, 7664, 179, 561, "Input"],
Cell[13836, 331, 144, 3, 32, "Input"]
}
]
*)

(* End of internal cache information *)
